define(["jquery"],function(a){function b(b,c,d){a("#block_samieattendance_toggleUserAttendance"+b).attr("src",M.cfg.wwwroot+"/blocks/samieattendance/pix/"+c+".png").attr("value",c);var e=parseInt(a("#studentAttendance"+b).val());a("#studentAttendance"+b).val(e+d);var f=parseInt(a("#courseCountAttendance").val()),g=100*(e+d)/f;a("#percentage"+b).text(g.toFixed(2)+" %")}function c(c,d,f,g){a.ajax({url:M.cfg.wwwroot+"/blocks/samieattendance/requests.php",type:"POST",async:!0,data:{action:c,alu_id:f,course_id:d,asi_fecha:g},success:function(a){try{if("OK"==a)if(f==e&&"setAttendance"==c)window.location=window.location,location.reload(!0);else{var d="setAttendance"==c?1:-1,g="setAttendance"==c?"ok":"fail";b(f,g,d)}return}catch(a){}},error:function(){}})}function d(b,d,e){var f="setAttendance";"ok"==a("#block_samieattendance_toggleUserAttendance"+d).attr("value")&&(f="delAttendance"),c(f,b,d,e)}var e=-1;return{toggle_samie_user_attendance:c,toggle_user_attendance:d,init:function(a){e=a}}});